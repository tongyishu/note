# TOS

TOS（Type of Service）为服务类型，定义在L3 IP报文头的tos字段中，该字段一共8位，但实际上tos只占据其中的3位。

详细介绍参见RFC文档：
https://www.rfc-editor.org/rfc/rfc791

```bash
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Version|  IHL  |Type of Service|          Total Length         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         Identification        |Flags|      Fragment Offset    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Time to Live |    Protocol   |         Header Checksum       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Source Address                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Destination Address                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Options                    |    Padding    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
```

TOS的具体字段如下：

```bash
             +-----+-----+-----+-----+-----+-----+-----+-----+
             |                 |                       |     |
             |   PRECEDENCE    |          TOS          | MBZ |
             |                 |                       |     |
             +-----+-----+-----+-----+-----+-----+-----+-----+
```

PRECEDENCE表示IP优先级（已废弃，默认全0），3bit，取值范围0~7，0优先级最低，7优先级最高。

TOS表示服务类型，4bit，1000表示最小延迟，0100表示最大吞吐，0010表示最高可靠，0001表示最小费用，0000表示正常服务。

MBZ表示Must Be zero，为保留位。

详细介绍参见RFC文档：
https://www.rfc-editor.org/rfc/rfc1349

# DSCP

DSCP（Differentiated Service Code Point）为差分服务代码点。随着网络的发展，服务类型越来越多，TOS中的3bit已经远远不够用，于是RFC2474对TOS所在的8bit重新分配，并将其命名为DSCP。

```bash
      +---+---+---+---+---+---+---+---+
      |         DSCP          |  CU   |
      +---+---+---+---+---+---+---+---+
```

DSCP表示服务类型，6bit，取值范围0~63，0优先级最低，63优先级最高。

CU未使用，保留。

详细介绍参见RFC文档：
https://www.rfc-editor.org/rfc/rfc2474
