# 为什么要将IP组播地址转换成MAC组播地址?

单播IP与单播MAC一一对应: 可以通过ARP协议获取单播IP对应的单播MAC。

组播IP如何与MAC地址对应? 一个组播IP对应一组单播MAC太浪费资源, 且不好管理。因此采取的办法是让组播IP和组播MAC对应起来: 一个组播IP对应一个组播MAC, 一个组播MAC对应多个组播IP。

# 常见的IPv4组播地址

IANA（**Internet Assigned Numbers Authority** , 互联网编号分配委员会）将D类地址空间分配给IPv4组播使用。D类地址最高4位为1110, 因此地址范围为224.0.0.0 ~ 239.255.255.255。

* `224.0.0.1` 网段内所有设备的地址
* `224.0.0.2` 网段内所有路由设备的地址
* `224.0.0.3` 不分配
* `224.0.0.4` DVMRP（Distance Vector Multicast Routing Protocol, 距离矢量组播路由协议）路由器的地址
* `224.0.0.5` OSPF（Open Shortest Path First, 开放最短路径优先）路由器的地址

# 常见的IPv6组播地址

RFC（**Request for Comments** ）对IPv6组播的定义如下:

* 0~7 : 组播标识, 固定为0xFF
* 8~11 : 组播类型, 0表示IANA所分配的一个永久分配地址, 1表示当前的组播地址是一个临时组播地址
* 12~15 : 组播组范围, 1表示接口范围, 2表示链路范围, 5表示站点范围, E表示全球范围
* 16~127 : 组播组ID, 112bits

常见的组播地址如下：

* `FF01::1` 本地接口范围内所有设备的地址
* `FF02::1` 本地链路范围内所有设备的地址
* `FF03::1` 本地子网范围内所有设备的地址
* `FF04::1` 本地管理范围内所有设备的地址
* `FF05::1` 本地站点范围内所有设备的地址
* `FF08::1` 组织机构范围内所有设备的地址
* `FF0E::1` 整个全球范围内所有设备的地址

# 转换机制

IPv4组播MAC地址:

* MAC地址的高24位固定为0x01005E (01:00:5E)
* MAC地址的第25位为固定为0
* MAC地址的低23位为IPv4组播地址的低23位

**eg.**

`224.0.0.1 => 01:00:5E:00:00:01`

`225.0.0.1 => 01:00:5E:00:00:01`

IPv6组播MAC地址:

* MAC地址的高16位固定为0x3333 (33:33)
* MAC地址的低32位为IPv6组播地址的低32位

**eg.** 

`FF01::1 => 33:33:00:00:00:01`

`FF02::1 => 33:33:00:00:00:01`
