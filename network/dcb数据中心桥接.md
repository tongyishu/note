# 一、DCB的核心标准

DCB（Data Center Bridging，数据中心桥接）是一组针对数据中心网络优化的IEEE标准，旨在解决传统以太网在数据中心场景下的不足（如拥塞导致的丢包、带宽分配不均、实时性要求高等）。它通过增强以太网的流量控制、带宽管理和时序同步能力，为数据中心的关键应用（如虚拟化、存储网络、实时计算）提供更可靠、高效的网络环境。

DCB基于IEEE 802.1系列标准，主要包含以下关键子标准，共同构成完整的技术体系：

| 标准编号           | 全称                                   | 核心功能                                                         |
| ------------------ | -------------------------------------- | ---------------------------------------------------------------- |
| **802.1Qbb** | Priority-based Flow Control（PFC）     | 基于优先级的流量控制，防止特定优先级流量因拥塞丢包               |
| **802.1Qaz** | Enhanced Transmission Selection（ETS） | 增强型传输选择，为不同优先级流量分配固定带宽                     |
| **802.1Qat** | Congestion Notification（CN）          | 拥塞通知，告知发送端网络拥塞状态以调整发送速率                   |
| **802.1AS**  | Timing and Synchronization             | 时间同步（精确时间协议 PTP），确保网络设备时钟同步，支持实时业务 |

# 二、DCB的关键功能

DCB通过上述标准，重点解决数据中心网络的三大痛点：**拥塞丢包** 、**带宽竞争**和**实时性需求** 。以下是其核心功能的详细说明：

## 1. 基于优先级的流量控制（PFC，802.1Qbb）

传统以太网的全局流量控制（PAUSE帧）会暂停整条链路的所有流量，可能导致高优先级业务（如存储 IO、实时通信）被 "连带暂停"，影响关键业务性能。PFC的核心是**按优先级独立控制流量** ：

* 将流量划分为最多8个优先级（0-7）；
* 当某优先级的流量发生拥塞时，仅向发送端发送该优先级的PAUSE帧，其他优先级流量仍可正常传输；
* 避免高优先级业务（如iSCSI存储流量）因低优先级业务（如文件下载）的拥塞而丢包。

## 2. 增强型传输选择（ETS，802.1Qaz）

数据中心中不同业务（如VM迁移、数据库同步、视频流）对带宽的需求差异极大，传统以太网的"先到先得"机制会导致关键业务抢占不到足够资源。ETS的核心是**为不同优先级分配固定带宽** ：

* 管理员可定义每个优先级的带宽权重（如优先级7分配30%带宽，优先级6分配50%，其他分配20%）；
* 交换机根据权重调度各优先级队列的流量，确保高优先级业务获得稳定带宽；
* 支持"剩余带宽共享"：当某优先级未用尽分配的带宽时，其他优先级可临时借用，提升带宽利用率。

## 3. 拥塞通知（CN，802.1Qat）

传统以太网依赖丢包触发重传（如TCP的拥塞控制），但数据中心的高带宽场景下，丢包会导致吞吐量骤降（需等待重传）。CN的核心是**提前通知拥塞状态** ：

* 当交换机检测到队列拥塞（如缓存占用超过阈值），向发送端标记数据包的ECN（Explicit Congestion Notification，显式拥塞通知）位；
* 发送端（如支持DCB的网卡或主机）收到标记后，主动降低发送速率，避免拥塞加剧；
* 与PFC配合，实现 "无丢包拥塞控制"，提升关键业务的稳定性。

## 4. 时间同步（802.1AS）

数据中心的实时业务（如高频交易、工业控制）需要网络设备时钟严格同步，传统NTP（网络时间协议）精度不足（毫秒级）。802.1AS基于PTP（Precision Time Protocol，精确时间协议），实现**亚微秒级时钟同步** ：

* 通过网络链路（如以太网）传递时间戳报文，校准从设备与主设备的时钟；
* 支持"边界时钟"（Boundary Clock）和"透明时钟"（Transparent Clock）模式，适应复杂网络拓扑；
* 为TSN（时间敏感网络）等实时业务提供基础支撑。
