# 什么是MBR

MBR（Master Boot Record，主引导记录）位于硬盘的第一个扇区（0磁道、0柱面、1扇区），用于记录启动引导程序和磁盘分区表。

MBR一共占用一个扇区，也就是512字节。其中446字节安装了引导程序，其后64字节用于描述分区表，最后的2字节为结束标记。

```bash
+----------------------------+-----------------------------+-------------------------+
|      boot code (446B)      |    partition table (64B)    |    magic number (2B)    |
+----------------------------+-----------------------------+-------------------------+
```

- **boot code**: 启动引导程序，包含启动操作系统的初始代码。BIOS在开机时加载并执行这段代码，随后会查找活动分区并加载其引导扇区（如Windows的`BOOTMGR`或Linux的`GRUB`）。
- **partition table**: 分区表，包含4个分区表项，每个表项16字节，描述一个主分区的信息（起始位置、大小、类型等）。每个MBR硬盘最多只能划分4个分区，原因就在于此。
- **magic number**: 结束标记，固定为0x55AA

# 分区表内容

每个分区的内容如下：


| 偏移量 | 长度 | 描述                                                                |
| -------- | ------ | --------------------------------------------------------------------- |
| 0x00   | 1B   | **活动分区标志** ：`0x80`表示活动分区（可引导），`0x00`表示非活动   |
| 0x01   | 3B   | **分区起始CHS地址** （Cylinder-Head-Sector）                        |
| 0x04   | 1B   | **分区类型** （如`0x07`为NTFS，`0x83`为Linux，`0xEE`为GPT保护分区） |
| 0x05   | 3B   | **分区结束CHS地址**                                                 |
| 0x08   | 4B   | **分区起始逻辑块地址**，现代系统使用                                |
| 0x0C   | 4B   | **分区扇区总数** （即分区大小）                                     |

# 备份MBR内容

```bash
dd if=/dev/sda of=mbr bs=512 count=1
```

# 查看MBR内容

```bash
hexdump -C -n 512 /dev/sda
```
